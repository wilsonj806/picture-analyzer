!function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){},function(t,n,e){"use strict";e.r(n);var r=function(){let t="";return{setEle:function(n){return t=document.querySelector(n),console.log(this),t},getListener:function(t,n,e){return t.addEventListener(n,e),console.log(this),this}}}();var o=class{constructor(t,n,e){this.canvas=document.querySelector(t),this.btnUpload=document.querySelector(n),this.dropzone=document.querySelector(e),this.ctx=this.canvas.getContext("2d")}fileWarn(t=""){const n=r.setEle(".intro"),e=document.createElement("p");switch(e.classList.add("js-danger-popup"),t){case"wrongType":e.innerText="Warning, you are trying to upload an unrecognized image file type. Accepted file types are (.png,.jpg,.bmp,.tiff,.svg, etc)";break;case"wrongSize":e.innerText="Warning, image too big. Please limit file size to less than 1 Mb";break;case"tooMany":e.innerText="Warning, you are trying to upload more than one file. The app does not process more than one image at a time.";break;case"empty":n.childNodes.forEach(t=>{1===t.nodeType&&!0===t.classList.contains("js-danger-popup")&&n.removeChild(t)})}return e.innerText?(n.appendChild(e),this):this}handleFile(t,n){const e=t[0];if(this.fileWarn("empty"),!e.type.startsWith("image"))return void this.fileWarn("wrongType");if(e.size>1e6)return void this.fileWarn("wrongSize");if(t.length>1)return void this.fileWarn("tooMany");const{canvas:o,ctx:s,btnUpload:i}=this,a=r.setEle(".strip"),c=document.createElement("img"),l=document.createElement("li");i.value="",c.src=window.URL.createObjectURL(e),c.classList.add("strip__img"),l.classList.add("strip__item"),l.dataset.index=a.childElementCount+1,l.dataset.name=e.name,c.onload=(()=>{const t=document.querySelector(".canvas-wrapper").clientHeight/c.naturalHeight*.9,e=c.naturalWidth*t,r=c.naturalHeight*t;o.width=e,o.height=r,s.drawImage(c,0,0,e,r),l.appendChild(c),a.appendChild(l),window.URL.revokeObjectURL(c.src),n.setPixels(s,o.width,o.height).parsePixels()})}handleBtnUpload(t,n){const e=t.target.files;this.handleFile(e,n)}handleDrop(t,n){t.stopPropagation(),t.preventDefault();const e=t.dataTransfer.files;this.handleFile(e,n)}};function s(t,n,e,r=0){const o=a(t,n,e),s=o-c(t,n,e);if(s){const r=o===t?(n-e)/s:o===n?(e-t)/s:(t-n)/s;return 60*(r+(o===t?r<0?6:0:o===n?2:4))}return r}function i(t,n,e){const r=e<0?e+360:e>360?e-360:e;return 6*r<360?t+(n-t)*r/60:2*r<360?n:3*r<720?t+(n-t)*(240-r)/60:t}function a(t,n,e){return Math.max(t,n,e)}function c(t,n,e){return Math.min(t,n,e)}function l(t,n){return n.map(n=>n.reduce((n,e,r)=>n+t[r]*e,0))}const[u,h,d]=[96.42,100,82.49],p=Math.pow(6,3)/Math.pow(29,3),f=Math.pow(29,3)/Math.pow(3,3);function g(t,n,e,r){const o=s(t,n,e,r),i=a(t,n,e),l=c(t,n,e),u=i-l,h=(i+l)/2;return[o,0===u?0:u/(100-Math.abs(2*h-100))*100,h]}function b(t,n,e){const r=e<=50?e*(n+100)/100:e+n-e*n/100,o=2*e-r,[s,a,c]=[i(o,r,t+120),i(o,r,t),i(o,r,t-120)];return[s,a,c]}function m(t,n,e,r){return[s(t,n,e,r),c(t,n,e),100-a(t,n,e)]}function y(t,n,e,r){const[o,s,i]=b(t,100,50).map(t=>t*(100-n-e)/100+n);return[o,s,i]}function v(t,n,e,r){const o=a(t,n,e),i=c(t,n,e);return[s(t,n,e,r),o===i?0:(o-i)/o*100,o]}function x(t,n,e){const r=Math.floor(t/60),o=e*(100-n)/100,s=e*(100-n*(t/60-r&1?t/60-r:1-t/60-r))/100,[i,a,c]=5===r?[e,o,s]:4===r?[s,o,e]:3===r?[o,s,e]:2===r?[o,e,s]:1===r?[s,e,o]:[e,s,o];return[i,a,c]}function w(t,n,e){const[r,o,s]=[t,n,e].map(t=>t>4.045?100*Math.pow((t+5.5)/105.5,2.4):t/12.92),[i,a,c]=l([r,o,s],[[.4124564,.3575761,.1804375],[.2126729,.7151522,.072175],[.0193339,.119192,.9503041]]);return[i,a,c]}function M(t,n,e){const[r,o,s]=l([t,n,e],[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]]),[i,a,c]=[r,o,s].map(t=>t>.31308?1.055*Math.pow(t/100,1/2.4)*100-5.5:12.92*t);return[i,a,c]}function C(t,n,e){const r=n*(e<50?e:100-e)/100;return[t,0===r?0:2*r/(e+r)*100,e+r]}function E(t,n,e){const r=(200-n)*e/100,[o,s]=[0===r||200===r?0:n*e/100/(r<=100?r:200-r)*100,5*r/10];return[t,o,s]}function L(t,n,e){const[r,o,s]=[t,100===e?0:100-n/(100-e)*100,100-e];return[r,o,s]}function _(t,n,e){const[r,o,s]=[t,(100-n)*e/100,100-e];return[r,o,s]}function z(t,n,e){const r=(t+16)/116,o=n/500+r,s=r-e/200,[i,a,c]=[Math.pow(o,3)>p?Math.pow(o,3):(116*o-16)/f,t>f*p?Math.pow((t+16)/116,3):t/f,Math.pow(s,3)>p?Math.pow(s,3):(116*s-16)/f],[g,b,m]=l([i*u,a*h,c*d],[[.9555766,-.0230393,.0631636],[-.0282895,1.0099416,.0210077],[.0122982,-.020483,1.3299098]]);return[g,b,m]}function S(t,n,e){const[r,o,s]=l([t,n,e],[[1.0478112,.0228866,-.050127],[.0295424,.9904844,-.0170491],[-.0092345,.0150436,.7521316]]),[i,a,c]=[r/u,o/h,s/d].map(t=>t>p?Math.cbrt(t):(f*t+16)/116),[g,b,m]=[116*a-16,500*(i-a),200*(a-c)];return[g,b,m]}function T(t,n,e){const[r,o]=[Math.sqrt(Math.pow(n,2)+Math.pow(e,2)),180*Math.atan2(e,n)/Math.PI];return[t,r,o]}function P(t,n,e){const[r,o]=[n*Math.cos(e*Math.PI/180),n*Math.sin(e*Math.PI/180)];return[t,r,o]}var j={rgb2hsl:g,rgb2hwb:m,rgb2lab:function(t,n,e){const[r,o,s]=w(t,n,e),[i,a,c]=S(r,o,s);return[i,a,c]},rgb2lch:function(t,n,e){const[r,o,s]=w(t,n,e),[i,a,c]=S(r,o,s),[l,u,h]=T(i,a,c);return[l,u,h]},rgb2hsv:v,rgb2xyz:w,hsl2rgb:b,hsl2hwb:function(t,n,e){const[,r,o]=C(t,n,e),[,s,i]=_(t,r,o);return[t,s,i]},hsl2lab:function(t,n,e){const[r,o,s]=b(t,n,e),[i,a,c]=w(r,o,s),[l,u,h]=S(i,a,c);return[l,u,h]},hsl2lch:function(t,n,e){const[r,o,s]=b(t,n,e),[i,a,c]=w(r,o,s),[l,u,h]=S(i,a,c),[d,p,f]=T(l,u,h);return[d,p,f]},hsl2hsv:C,hsl2xyz:function(t,n,e){const[r,o,s]=b(t,n,e),[i,a,c]=w(r,o,s);return[i,a,c]},hwb2rgb:y,hwb2hsl:function(t,n,e){const[r,o,s]=L(t,n,e),[i,a,c]=E(r,o,s);return[i,a,c]},hwb2lab:function(t,n,e){const[r,o,s]=y(t,n,e),[i,a,c]=w(r,o,s),[l,u,h]=S(i,a,c);return[l,u,h]},hwb2lch:function(t,n,e){const[r,o,s]=y(t,n,e),[i,a,c]=w(r,o,s),[l,u,h]=S(i,a,c),[d,p,f]=T(l,u,h);return[d,p,f]},hwb2hsv:L,hwb2xyz:function(t,n,e){const[r,o,s]=y(t,n,e),[i,a,c]=w(r,o,s);return[i,a,c]},lab2rgb:function(t,n,e){const[r,o,s]=z(t,n,e),[i,a,c]=M(r,o,s);return[i,a,c]},lab2hsl:function(t,n,e,r){const[o,s,i]=z(t,n,e),[a,c,l]=M(o,s,i),[u,h,d]=g(a,c,l,r);return[u,h,d]},lab2hwb:function(t,n,e,r){const[o,s,i]=z(t,n,e),[a,c,l]=M(o,s,i),[u,h,d]=m(a,c,l,r);return[u,h,d]},lab2lch:T,lab2hsv:function(t,n,e,r){const[o,s,i]=z(t,n,e),[a,c,l]=M(o,s,i),[u,h,d]=v(a,c,l,r);return[u,h,d]},lab2xyz:z,lch2rgb:function(t,n,e){const[r,o,s]=P(t,n,e),[i,a,c]=z(r,o,s),[l,u,h]=M(i,a,c);return[l,u,h]},lch2hsl:function(t,n,e,r){const[o,s,i]=P(t,n,e),[a,c,l]=z(o,s,i),[u,h,d]=M(a,c,l),[p,f,b]=g(u,h,d,r);return[p,f,b]},lch2hwb:function(t,n,e,r){const[o,s,i]=P(t,n,e),[a,c,l]=z(o,s,i),[u,h,d]=M(a,c,l),[p,f,g]=m(u,h,d,r);return[p,f,g]},lch2lab:P,lch2hsv:function(t,n,e,r){const[o,s,i]=P(t,n,e),[a,c,l]=z(o,s,i),[u,h,d]=M(a,c,l),[p,f,g]=v(u,h,d,r);return[p,f,g]},lch2xyz:function(t,n,e){const[r,o,s]=P(t,n,e),[i,a,c]=z(r,o,s);return[i,a,c]},hsv2rgb:x,hsv2hsl:E,hsv2hwb:_,hsv2lab:function(t,n,e){const[r,o,s]=x(t,n,e),[i,a,c]=w(r,o,s),[l,u,h]=S(i,a,c);return[l,u,h]},hsv2lch:function(t,n,e){const[r,o,s]=x(t,n,e),[i,a,c]=w(r,o,s),[l,u,h]=S(i,a,c),[d,p,f]=T(l,u,h);return[d,p,f]},hsv2xyz:function(t,n,e){const[r,o,s]=x(t,n,e),[i,a,c]=w(r,o,s);return[i,a,c]},xyz2rgb:M,xyz2hsl:function(t,n,e,r){const[o,s,i]=M(t,n,e),[a,c,l]=g(o,s,i,r);return[a,c,l]},xyz2hwb:function(t,n,e,r){const[o,s,i]=M(t,n,e),[a,c,l]=m(o,s,i,r);return[a,c,l]},xyz2lab:S,xyz2lch:function(t,n,e){const[r,o,s]=S(t,n,e),[i,a,c]=T(r,o,s);return[i,a,c]},xyz2hsv:function(t,n,e,r){const[o,s,i]=M(t,n,e),[a,c,l]=v(o,s,i,r);return[a,c,l]},rgb2hue:s};var A=class{constructor(){this.pixelData=[],this.rgbArr=[],this.rgbCount=[],this.hslArr=[],this.lightnessQty=[],this.pixelCount=void 0}disposeArr(){this.pixelData=[],this.rgbArr=[],this.rgbCount=[],this.hslArr=[]}setPixels(t,n,e){return this.pixelData.width&&(this.disposeArr(),console.log("disposing")),this.pixelData=t.getImageData(0,0,n,e),this}parsePixels(){const t=this.pixelData,n=t.data.length;for(let e=0;e<n;e+=4){const n=t.data[e+0],r=t.data[e+1],o=t.data[e+2],s=[].concat(n,r,o);this.rgbArr.push(s)}return this.pixelCount=this.rgbArr.length,this}rgb2Hsl(){const t=this.pixelData;for(let n=0;n<t.data.length;n+=4){const e=t.data[n+0],r=t.data[n+1],o=t.data[n+2],s=j.rgb2hsl(e,r,o).map(t=>Math.round(t));this.hslArr.push(s[2])}return this}getLightness(){const t=this.hslArr.reduce((t,n)=>(t[n]||(t[n]=0),t[n]+=1,t),{}),n=Object.entries(t);return this.lightnessQty=n,n}};function k(t,n){return Math.round(t.length*n)}function D(t,n,e=!1,r=0){if(!0===e&&1===n.length){const e=[...n],r=e.splice(0),o=[[...t[0]],t[1]];return o[1]+=r[0][1],e.push(o),e}if(!0===e){const e=[...n],o=e.splice(r,1),s=[[...t[0]],t[1]];return s[1]+=o[0][1],e.push(s),e}const o=[...n],s=[[...t[0]],t[1]];return s[1]=1,o.push(s),o}function O(t,n=!1,e=0){if(!0===n){let n=t.reduce((t,n)=>null===n?t:t+=n[e],0)/t.length;return n<15&&(n=15),n}let r=t.reduce((t,n)=>t+=n,0)/t.length;return r<15&&(r=15),r}function U(t,n){const e=Math.abs((t-n)/n);return e<=1.2&&e>1||e<=.2}function W(t){const n=t,e=k(n,.25),r=k(n,.5),o=k(n,.75);return n.reduce((t,n,s)=>{!function(t,n){0===t.length&&(t=D(n,t)),1===t.length&&(t=!0===U(O(n[0]),O(t[0]))?D(n,t,!0):D(n,t))}(t,n);const i=O(n[0]),a=t.some(t=>{const n=O(t[0]);return U(i,n)});if(t.length<6&&!1===a)t=D(n,t);else{if(6===t.length||s===r){for(let n=0;n===t.length;n+=1){const e=O(t[n][0]),r=t.findIndex(t=>{return U(O(t[0]),e)});t=D(t[n],t,!0,r)}return t}if(!0===a){return t=D(n,t,!0,t.findIndex(t=>{const n=O(t[0]);return U(i,n)}))}s!==r&&s!==e&&s!==o||(t.sort((t,n)=>t[1]<n[1]?1:t[1]>n[1]?-1:0),t[0][1]<=1&&t.shift())}return t},[])}var q=class{constructor(t,n,e,r){this.target=document.querySelector(t),this.btnColor=document.querySelector(n),this.btnClipping=document.querySelector(e),this.entryClass=r}dumpContents(t){return this.target.childElementCount>0&&Array.from(this.target.children).forEach(t=>{this.target.removeChild(t)}),this.makeTable(t),this}downloadCSV(t,n){let e=`${t}\n    `;e+="val; count \n",n.forEach(t=>{e+=t.join(";"),e+="\n"});const r=document.createElement("a");return r.href=`data:text/csv;charset=utf-8, ${encodeURI(e)}`,r.target="_blank",r.download=`${t}.csv`,r.click(),this}makeTable(t){return t.forEach(t=>{const n=document.createElement("div"),e=document.createElement("div"),r=document.createElement("p");n.classList.add("display__entry"),e.style.height="50px",e.style.width="50px",e.style.backgroundColor=`rgb(${t[0]})`,e.classList.add("card","card--color"),r.innerText=`rgb(${t[0]})`,r.classList.add("display__label"),n.appendChild(e),n.appendChild(r),this.target.appendChild(n)}),this}presentStrings(t){this.target.childElementCount>0&&Array.from(this.target.children).forEach(t=>{this.target.removeChild(t)});const n=document.createElement("div"),e=document.createElement("p"),r=document.createElement("p");return n.classList.add("card","card--text"),e.classList.add("display__text"),r.classList.add("display__text"),[e.innerText,r.innerText]=t,n.appendChild(e),n.appendChild(r),this.target.appendChild(n),this}};const I=new o("#canvas",'[type="file"]',".drop__target"),$=new A,F=new q(".display",".btn--color",".btn--clip","display__entry"),{dropzone:H,btnUpload:R}=I,{btnColor:B,btnClipping:Q}=F;H.addEventListener("dragenter",t=>{t.stopPropagation(),t.preventDefault()}),H.addEventListener("dragover",t=>{t.stopPropagation(),t.preventDefault()}),H.addEventListener("drop",t=>{I.handleDrop(t,$)}),R.addEventListener("change",t=>{I.handleBtnUpload(t,$)}),B.addEventListener("click",()=>{$.rgbCount=function(t){return t.reduce((t,n)=>(0===t.length?t.push([n,0]):!0===U(O(n),O(t[t.length-1]))?t[t.length-1][1]+=1:t.push([n,1]),t),[])}($.rgbArr);const t=W($.rgbCount);F.dumpContents(t)}),Q.addEventListener("click",()=>{$.rgb2Hsl();const t=function(t,n){const e=[...t],r=k(e,.25),o=k(e,.75),s=e.slice(0,r-1),i=e.slice(o-1,e.length-1),a=s.map((t,n)=>n===s.length-1?null:[n,[s[n+1][0],t[0]],Math.abs(s[n+1][1]-t[1])]),c=i.map((t,n)=>n===i.length-1?null:[n,[i[n+1][0],t[0]],Math.abs(i[n+1][1]-t[1])]),l=O(a,!0,2),u=O(c,!0,2),h=a.filter(t=>null!==t&&t[2]>2*l),d=c.filter(t=>null!==t&&t[2]>2*u),p=O(h,!0,2),f=O(d,!0,2);return[`This is percent of black clipping: ${(100*(1-(n-p)/n)).toFixed(2)} %`,`This is percent of white clipping: ${(100*(1-(n-f)/n)).toFixed(2)} %`]}($.getLightness(),$.pixelCount);F.presentStrings(t)});e(0)}]);